# ğŸ“š 11ì¥ í•©ì„±ê³¼ ìœ ì—°í•œ ì„¤ê³„

í•©ì„±
- ì „ì²´ë¥¼ í‘œí˜„í•˜ëŠ” ê°ì²´ê°€ ë¶€ë¶„ì„ í‘œí˜„í•˜ëŠ” ê°ì²´ë¥¼ í¬í•¨í•´ì„œ ë¶€ë¶„ ê°ì²´ì˜ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•œë‹¤.
- ë‘ ê°ì²´ ì‚¬ì´ì˜ ì˜ì¡´ì„±ì€ ëŸ°íƒ€ì„ì— í•´ê²°ëœë‹¤.
- has-a ê´€ê³„ë¼ê³  ë¶€ë¥¸ë‹¤.
- êµ¬í˜„ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.
  - ë‚´ë¶€ì— í¬í•¨ë˜ëŠ” ê°ì²´ì˜ êµ¬í˜„ì´ ì•„ë‹Œ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•œë‹¤.
  - ë”°ë¼ì„œ ë‚´ë¶€ì— í¬í•¨ëœ ê°ì²´ì˜ êµ¬í˜„ì´ ë³€ê²½ë˜ë”ë¼ë„ ì˜í–¥ì„ ìµœì†Œí™”í• ìˆ˜ ìˆì–´ ì•ˆì •ì ì´ë‹¤.
- ê°ì²´ ì‚¬ì´ì˜ ë™ì ì¸ ê´€ê³„ì´ë‹¤.
  - ì‹¤í–‰ ì‹œì ì— ë™ì ìœ¼ë¡œ ë³€ê²½ì´ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì´ë‹¤.
- ë‚´ë¶€ì— í¬í•¨ë˜ëŠ” í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¬ì‚¬ìš© í•œë‹¤.
  - ë”°ë¼ì„œ ê°ì²´ ì‚¬ì´ì˜ ë‚®ì€ ê²°í•©ë„ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.

## ğŸ“– 11.1 ìƒì†ì„ í•©ì„±ìœ¼ë¡œ ë³€ê²½í•˜ê¸°

ìƒì† ë‚¨ìš©ì‹œ ì„¸ê°€ì§€ ë¬¸ì œ

1. ë¶ˆí•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ ìƒì† ë¬¸ì œ
   - ìì‹ í´ë˜ìŠ¤ì—ê²ŒëŠ” ë¶€ì í•©í•œ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ì˜¤í¼ë ˆì´ì…˜ì´ ìƒì†ë˜ê¸° ë•Œë¬¸ì— ìì‹ í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒíƒœê°€ ë¶ˆì•ˆì •í•´ì§€ëŠ” ë¬¸ì œ
2. ë©”ì„œë“œ ì˜¤ë²„ë¼ì´ë”© ì˜¤ì‘ìš© ë¬¸ì œ
   - ìì‹ í´ë˜ìŠ¤ê°€ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”©í•  ë•Œ ìì‹ í´ë˜ìŠ¤ê°€ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œ í˜¸ì¶œ ë°©ë²•ì— ì˜í–¥ì„ ë°›ëŠ” ë¬¸ì œ
3. ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ì˜ ë™ì‹œ ìˆ˜ì • ë¬¸ì œ
   - ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ ì‚¬ì´ì˜ ê°œë…ì ì¸ ê²°í•©ìœ¼ë¡œ ì¸í•´ ë¶€ëª¨ í´ë˜ìŠ¤ë¥¼ ë³€ê²½í•  ë•Œ ìì‹ í´ë˜ìŠ¤ë„ í•¨ê»˜ ë³€ê²½í•´ì•¼ í•˜ëŠ” ë¬¸ì œ

í•©ì„±ì„ ì‚¬ìš©í•˜ë©´ ìƒì†ì´ ì´ˆë˜í•˜ëŠ” ìœ„ ì„¸ê°€ì§€ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

### ğŸ”– 11.1.1 ë¶ˆí•„ìš”í•œ ì¸í„°í˜ì´ìŠ¤ ìƒì† ë¬¸ì œ: java.util.properties ì™€ java.util.stack

```java
public class Properties {
    // properties ì—ì„œ ìƒì† ê´€ê³„ë¥¼ ì œê±°í•˜ê³  HashTableì„ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ í¬í•¨ì‹œí‚¤ë©´ í•©ì„± ê´€ê³„ë¡œ ë³€ê²½ ê°€ëŠ¥
    private Hashtable<String, String> properties = new Hashtable<>();

    public String setProperty(final String key, final String value) {
        return properties.put(key, value);
    }

    public String getProperty(final String key) {
        return properties.get(key);
    }
}
```
ë¶ˆí•„ìš”í•œ hashTable ì˜ ì˜¤í¼ë ˆì´ì…˜ë“¤ì´ Properties í´ë˜ìŠ¤ì˜ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì˜¤ì—¼ì‹œí‚¤ì§€ ì•Šê³  í´ë¼ì´ì–¸íŠ¸ëŠ” ì˜¤ì§ Properties ì—ì„œ
ì •ì˜í•œ ì˜¤í¼ë ˆì´ì…˜ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ë‚´ë¶€ êµ¬í˜„ì— ë°€ì ‘í•˜ê²Œ ê²°í•©ë˜ëŠ” ìƒì†ê³¼ ë‹¬ë¦¬ í•©ì„±ìœ¼ë¡œ ë³€ê²½í•œ PropertiesëŠ” HashTableì˜ ë‚´ë¶€ êµ¬í˜„ì— ê´€í•´ ì•Œì§€ ëª»í•œë‹¤.

```java
public class Stack<E> {
    private Vector<E> elements = new Vector<>();

    public E push(E item) {
        elements.addElement(item);
        return item;
    }

    public E pop() {
        if (elements.isEmpty()) {
            throw new EmptyStackException();
        }
        return elements.remove(elements.size() - 1);
    }
}
```
stack í´ë˜ìŠ¤ë„ ë§ˆì°¬ê°€ì§€ë¡œ Vector ë¥¼ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ í¬í•¨ì‹œì¼œ í•©ì„±ì„ í• ìˆ˜ ìˆë‹¤.

### ğŸ”– 11.1.2 ë©”ì„œë“œ ì˜¤ë²„ë¼ì´ë”©ì˜ ì˜¤ì‘ìš© ë¬¸ì œ: InstrumentedHashSet

```java
public class InstrumentedHashSet<E> {
    @Getter
    private int addCount = 0;
    private Set<E> set;

    public InstrumentedHashSet(Set<E> set) {
        this.set = set;
    }

    public boolean add(E e) {
        addCount++;
        return set.add(e);
    }

    public boolean addAll(Collection<? extends E> c) {
        addCount += c.size();
        return set.addAll(c);
    }
}
```
Stack ì„ ë³€ê²½í•˜ëŠ” ê²ƒê³¼ ë‹¤ë¥¼ê²ƒ ì—†ë‹¤. í•˜ì§€ë§Œ í•´ë‹¹ í´ë˜ìŠ¤ëŠ” HashSetì´ ì œê³µí•˜ëŠ” í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ì œê³µí•´ì•¼ í•œë‹¤.

í•´ê²° ë°©ë²•ì€ set ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ê²° í• ìˆ˜ ìˆë‹¤.

```java
public class InstrumentedHashSet<E> implements Set<E> {
    @Getter
    private int addCount = 0;
    private Set<E> set;

    public InstrumentedHashSet(Set<E> set) {
        this.set = set;
    }

    public boolean add(E e) {
        addCount++;
        return set.add(e);
    }

    public boolean addAll(Collection<? extends E> c) {
        addCount += c.size();
        return set.addAll(c);
    }

    @Override public int size() {return set.size();}
    @Override public boolean isEmpty() {return false;}
    @Override public boolean contains(Object o) {return false;}
    @Override public Iterator<E> iterator() {return null;}
    @Override public Object[] toArray() {return new Object[0];}
    @Override public <T> T[] toArray(T[] a) {return null;}
    @Override public boolean remove(Object o) {return false;}
    @Override public boolean containsAll(Collection<?> c) {return false;}
    @Override public boolean retainAll(Collection<?> c) {return false;}
    @Override public boolean removeAll(Collection<?> c) {return false;}
    @Override public void clear() {}
}
```
í¬ì›Œë”© - ì˜¤ë²„ë¼ì´ë”©í•œ ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ ë‚´ì—ì„œ ë‚´ë¶€ HashSet ì¸ìŠ¤í„´ìŠ¤ì—ê²Œ ë™ì¼í•œ ë©”ì„œë“œ í˜¸ì¶œì„ ê·¸ëŒ€ë¡œ ì „ë‹¬
- ê¸°ì¡´ í´ë˜ìŠ¤ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ê·¸ëŒ€ë¡œ ì™¸ë¶€ì— ì œê³µ í•˜ë©´ì„œ êµ¬í˜„ì— ê²°í•© ì—†ì´ ì¼ë¶€ ì‘ë™ ë°©ì‹ì„ ë³€ê²½í•˜ê³  ì‹¶ì€ ê²½ìš°ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìœ ìš©í•œ ê¸°ë²•

í¬ì›Œë”© ë©”ì„œë“œ
- ë™ì¼í•œ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ì¶”ê°€ëœ ë©”ì„œë“œ

### ğŸ”– 11.1.3 ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ì˜ ë™ì‹œ ìˆ˜ì • ë¬¸ì œ:PersonalPlayList

```java
public class PersonalPlaylist {
    private Playlist playlist = new Playlist();

    public void append(Song song){
        playlist.append(song);
    }

    public void remove(Song song){
        playlist.getTracks().remove(song);
        playlist.getSingers().remove(song.getSinger());
    }
}
```
Playlist ê²½ìš°ì—ëŠ” í•©ì„±ìœ¼ë¡œ ë³€ê²½í•˜ë”ë¼ë„ ê°€ìˆ˜ë³„ ë…¸ë˜ ëª©ë¡ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ ë‘í´ë˜ìŠ¤ê°€ í•¨ê»˜ ìˆ˜ì •ë¼ì•¼ í•œë‹¤.

ê·¸ë˜ë„ í•©ì„±ì´ ì¢‹ì€ ì´ìœ ëŠ” í–¥í›„ Playlist ë‚´ë¶€ êµ¬í˜„ì„ ë³€ê²½í•˜ë”ë¼ë„ íŒŒê¸‰íš¨ê³¼ë¥¼ ìµœëŒ€í•œ PersonalPlaylist ë‚´ë¶€ë¡œ ìº¡ìŠí™” í• ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
ëŒ€ë¶€ë¶„ì˜ ê²½ìš° êµ¬í˜„ì— ëŒ€í•œ ê²°í•©ë³´ë‹¤ëŠ” ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•œ ê²°í•©ì´ ë” ì¢‹ë‹¤ëŠ” ì‚¬ì‹¤

ëª½í‚¤íŒ¨ì¹˜ - í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í™˜ê²½ì—ë§Œ ì˜í–¥ì„ ë¯¸ì¹˜ë„ë¡ ì§€ì—­ì ìœ¼ë¡œ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ í™•ì¥í•˜ëŠ”ê²ƒì„ ê°€ë¦¬í‚¨ë‹¤.

## ğŸ“– 11.2 ìƒì†ìœ¼ë¡œ ì¸í•œ ì¡°í•©ì˜ í­ë°œì ì¸ ì¦ê°€

ìƒì†ìœ¼ë¡œ ì¸í•´ ê²°í•©ë„ê°€ ë†’ì•„ì§€ë©´ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ëŠ” ë° í•„ìš”í•œ ì‘ì—…ì˜ ì–‘ì´ ê³¼ë„í•˜ê²Œ ëŠ˜ì–´ë‚˜ëŠ” ê²½í–¥ì´ ìˆë‹¤. 

ì¼ë°˜ì ìœ¼ë¡œ ë‘ê°€ì§€ ë¬¸ì œì 
1. í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ê¸° ìœ„í•´ ë¶ˆí•„ìš”í•˜ê²Œ ë§ì€ ìˆ˜ì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•´ì•¼ í•œë‹¤.
2. ë‹¨ì¼ ìƒì†ë§Œ ì§€ì›í•˜ëŠ” ì–¸ì–´ì—ì„œëŠ” ìƒì†ìœ¼ë¡œ ì¸í•´ ì˜¤íˆë ¤ ì¤‘ë³µ ì½”ë“œì˜ ì–‘ì´ ëŠ˜ì–´ë‚ ìˆ˜ ìˆë‹¤.

### ğŸ”– 11.2.1 ê¸°ë³¸ ì •ì±… ê³¼ ë¶€ê°€ ì •ì±… ì¡°í•©í•˜ê¸°

ë¶€ê°€ ì •ì±…ì€ í†µí™”ëŸ‰ê³¼ ë¬´ê´€í•˜ê²Œ ê¸°ë³¸ ì •ì±…ì— ì„ íƒì ìœ¼ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” ìš”ê¸ˆ ë°©ì‹ì„ ì˜ë¯¸í•œë‹¤.

ë¶€ê°€ ì •ì±…ì€ ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì„ ê°€ì§„ë‹¤.

1. ê¸°ë³¸ ì •ì±…ì˜ ê³„ì‚° ê²°ê³¼ì— ì ìš©ëœë‹¤.
   - ì„¸ê¸ˆ ì •ì±…ì€ ê¸°ë³¸ ì •ì±…ì¸ RegularPhone ì´ë‚˜ NightlyDiscountPhoneì˜ ê³„ì‚°ì´ ëë‚œ ê²°ê³¼ì— ì„¸ê¸ˆì„ ë¶€ê³¼í•œë‹¤.
2. ì„ íƒì ìœ¼ë¡œ ì ìš©í•  ìˆ˜ ìˆë‹¤.
   - ê¸°ë³¸ ì •ì±…ì˜ ê³„ì‚° ê²°ê³¼ì— ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•  ìˆ˜ë„ ìˆê³  ì ìš©í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤.
3. ì¡°í•© ê°€ëŠ¥í•˜ë‹¤.
   - ê¸°ë³¸ì •ì±…ì— ì„¸ê¸ˆ ì •ì±…ë§Œ ì ìš©í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ê³ , ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ë§Œ ì ìš©í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•˜ë‹¤. ë˜í•œ ì„¸ê¸ˆ ì •ì±…ê³¼ ê¸°ë³¸ ìš”ê¸ˆ
   í• ì¼ ì •ì±…ì„ í•¨ê»˜ ì ìš©í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•´ì•¼ í•œë‹¤.
4. ë¶€ê°€ ì •ì±…ì€ ì„ì˜ì˜ ìˆœì„œë¡œ ì ìš© ê°€ëŠ¥í•˜ë‹¤.
   - ê¸°ë³¸ ì •ì±…ì— ì„¸ê¸ˆ ì •ì±…ê³¼ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ í•¨ê»˜ ì ìš©í•  ê²½ìš° ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•œ í›„ì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•  ìˆ˜ë„ ìˆê³ 
   , ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•œ í›„ì— ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•  ìˆ˜ë„ ìˆë‹¤.

### ğŸ”– 11.2.2 ìƒì†ì„ ì´ìš©í•´ì„œ ê¸°ë³¸ ì •ì±… êµ¬í˜„í•˜ê¸°

```java
public abstract class Phone {
    // ê³µí†µ ë¶€ë¶„ì„ ì´ë™
    private List<Call> calls = new ArrayList<>();


    // ê³µí†µ ë¶€ë¶„ì„ ì´ë™
    public Money calculateFee() {
        Money result = Money.ZERO;

        for (Call call : calls) {
            result = result.plus(calculateCallFee(call));
        }
        return result;
    }

    abstract protected Money calculateCallFee(Call call);
}

@Getter
@AllArgsConstructor
public class RegularPhone extends Phone {
    private Money amount; // ë‹¨ìœ„ ìš”ê¸ˆì €ì¥
    private Duration seconds; //ë‹¨ìœ„ ì‹œê°„ì €ì¥
    private List<Call> calls = new ArrayList<>();

    public void call(Call call) {
        this.calls.add(call);
    }

    @Override
    protected Money calculateCallFee(Call call){
        return amount.times(call.getDuration().getSeconds()/seconds.getSeconds());
    }
}

public class NightlyDiscountPhone extends Phone {
    private static final int LATE_NIGHT_HOUR = 22;
    private Duration seconds; //ë‹¨ìœ„ ì‹œê°„ì €ì¥

    private Money nightlyAmount;
    private Money regularAmount;

    @Override
    protected Money calculateCallFee(Call call){
        if(call.getFrom().getHour() > LATE_NIGHT_HOUR){
            return nightlyAmount.times(call.getDuration().getSeconds()/ seconds.getSeconds());
        }
        return regularAmount.times(call.getDuration().getSeconds()/ seconds.getSeconds());
    }
}
```
RegularPhone ê³¼ NightlyDiscountPhone ì˜ ì¸ìŠ¤í„´ìŠ¤ë§Œ ë‹¨ë…ìœ¼ë¡œ ìƒì„±í•œë‹¤ëŠ” ê²ƒì€ ë¶€ê°€ ì •ì±…ì€ ì ìš©í•˜ì§€ ì•Šê³  ê¸°ë³¸ ì •ì±…ë§Œìœ¼ë¡œ ìš”ê¸ˆì„ ê³„ì‚°í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

### ğŸ”– 11.2.3 ê¸°ë³¸ ì •ì±…ì— ì„¸ê¸ˆ ì •ì±… ì¡°í•©í•˜ê¸°

```java
public class TaxableRegularPhone extends RegularPhone {
    private final double taxRate;

    public TaxableRegularPhone(Money amount, Duration seconds, List<Call> calls, double taxRate) {
        super(amount, seconds, calls);
        this.taxRate = taxRate;
    }

    @Override
    public Money calculateFee() {
        Money fee = super.calculateFee();
        return fee.plus(fee.times(taxRate));
    }
}
```
ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²• RegulatPhone ì„ ìƒì† ë°›ì•„ì„œ super ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œí›„ ê³„ì‚°í•˜ëŠ” ë°©ë²•

ì´ë ‡ê²Œ í•˜ë©´ ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ê²°í•©ì´ ë†’ì•„ì§€ê²Œ ëœë‹¤.

ê²°í•©ë„ë¥¼ ë‚®ì¶”ëŠ” ë°©ë²•ì€ ìì‹ í´ë˜ìŠ¤ê°€ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šë„ë¡ ë¶€ëª¨ í´ë˜ìŠ¤ì— ì¶”ìƒ ë©”ì„œë“œë¥¼ ì œê³µí•˜ëŠ” ê²ƒì´ë‹¤.

ìì‹ í´ë˜ìŠ¤ê°€ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”© í•´ì„œ ì›í•˜ëŠ” ë¡œì§ì„ ì œê³µë˜ë„ë¡ ìˆ˜ì •í•˜ë©´ ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ ì‚¬ì´ì˜ ê²°í•©ë„ë¥¼ ëŠìŠ¨í•˜ê²Œ ë§Œë“¤ìˆ˜ ìˆë‹¤.

```java
public abstract class Phone {
    // ê³µí†µ ë¶€ë¶„ì„ ì´ë™
    private List<Call> calls = new ArrayList<>();


    // ê³µí†µ ë¶€ë¶„ì„ ì´ë™
    public Money calculateFee() {
        Money result = Money.ZERO;

        for (Call call : calls) {
            result = result.plus(calculateCallFee(call));
        }
        return result;
    }

    abstract protected Money calculateCallFee(Call call);
    // ìƒˆë¡­ê²Œ ì¶”ê°€
    abstract protected Money afterCalculated(Money fee);
}
```

```java
@Getter
@AllArgsConstructor
public class RegularPhone extends Phone {
    private Money amount; // ë‹¨ìœ„ ìš”ê¸ˆì €ì¥
    private Duration seconds; //ë‹¨ìœ„ ì‹œê°„ì €ì¥
    private List<Call> calls = new ArrayList<>();

    public void call(Call call) {
        this.calls.add(call);
    }

    @Override
    protected Money calculateCallFee(Call call){
        return amount.times(call.getDuration().getSeconds()/seconds.getSeconds());
    }

    @Override
    protected Money afterCalculated(Money fee) {
        return fee;
    }
}
public class NightlyDiscountPhone extends Phone {
    private static final int LATE_NIGHT_HOUR = 22;
    private Duration seconds; //ë‹¨ìœ„ ì‹œê°„ì €ì¥

    private Money nightlyAmount;
    private Money regularAmount;

    @Override
    protected Money calculateCallFee(Call call){
        if(call.getFrom().getHour() > LATE_NIGHT_HOUR){
            return nightlyAmount.times(call.getDuration().getSeconds()/ seconds.getSeconds());
        }
        return regularAmount.times(call.getDuration().getSeconds()/ seconds.getSeconds());
    }

    @Override
    protected Money afterCalculated(Money fee) {
        return fee;
    }
}
```
ìœ„ ì½”ë“œì—ì„œ ì•Œìˆ˜ ìˆëŠ” ê²ƒ ì²˜ëŸ¼ ë¶€ëª¨ í´ë˜ìŠ¤ì—ê²Œ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ë©´ ëª¨ë“  ìì‹ í´ë˜ìŠ¤ë“¤ì´ ì¶”ìƒ ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë”© í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.

ëª¨ë“  ì¶”ìƒ ë©”ì„œë“œì˜ êµ¬í˜„ì´ ë™ì¼í•˜ë‹¤ëŠ” ì‚¬ì‹¤ì— ì£¼ëª©.
ìœ ì—°ì„±ì€ ìœ ì§€í•˜ë©´ì„œë„ ì¤‘ë³µ ì½”ë“œë¥¼ ì œê±°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ Phoneì—ì„œ afterCalculated ë©”ì„œë“œì— ëŒ€í•œ ê¸°ë³¸ êµ¬í˜„ì„ í•¨ê»˜ ì œê³µí•˜ëŠ” ê²ƒì´ë‹¤.

```java
public abstract class Phone {
    // ê³µí†µ ë¶€ë¶„ì„ ì´ë™
    private List<Call> calls = new ArrayList<>();


    // ê³µí†µ ë¶€ë¶„ì„ ì´ë™
    public Money calculateFee() {
        Money result = Money.ZERO;

        for (Call call : calls) {
            result = result.plus(calculateCallFee(call));
        }
        return afterCalculated(result);
    }

    abstract protected Money calculateCallFee(Call call);

    protected Money afterCalculated(Money fee){
        return fee;
    }
}
```
í›… ë©”ì„œë“œ
- ì¶”ìƒ ë©”ì„œë“œì™€ ë™ì¼í•˜ê²Œ ìì‹ í´ë˜ìŠ¤ì—ì„œ ì˜¤ë²„ë¼ì´ë”©í•  ì˜ë„ë¡œ ë©”ì„œë“œë¥¼ ì¶”ê°€í–ˆì§€ë§Œ í¸ì˜ë¥¼ ìœ„í•´ ê¸°ë³¸ êµ¬í˜„ì„ ì œê³µí•˜ëŠ” ë©”ì„œë“œë¥¼ í›… ë©”ì„œë“œë¼ê³  
ë¶€ë¥¸ë‹¤.

```java

public class TaxableRegularPhone extends RegularPhone {
    private final double taxRate;

    public TaxableRegularPhone(Money amount, Duration seconds, List<Call> calls, double taxRate) {
        super(amount, seconds, calls);
        this.taxRate = taxRate;
    }

    @Override
    public Money afterCalculated(Money fee) {
        return fee.plus(fee.times(taxRate));
    }
}

public class TaxableNightlyDiscountPhone extends NightlyDiscountPhone {
    private final double taxRate;

    public TaxableNightlyDiscountPhone(Duration seconds, Money nightlyAmount, Money regularAmount, double taxRate) {
        super(seconds, nightlyAmount, regularAmount);
        this.taxRate = taxRate;
    }
    
    @Override
    protected Money afterCalculated(Money fee){
        return fee.plus(fee.times(taxRate));
    }
}
```
ì„¸ê¸ˆì„ ì •ì±…ì„ ì¡°í•©í•˜ëŠ” ìš”ê¸ˆê³¼ ì¼ë°˜ìš”ê¸ˆì„ ì„ íƒí•´ì„œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

ë¬¸ì œëŠ” TaxableNighltDiscountPhone ê³¼ TaxableReularPhone ì‚¬ì´ì— ì½”ë“œë¥¼ ì¤‘ë³µí–ˆë‹¤ëŠ” ê²ƒì´ë‹¤.

ìë°”ëŠ” ë‹¨ì¼ ìƒì†ë§Œì„ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ìƒì†ìœ¼ë¡œ ì¸í•´ ë°œìƒí•˜ëŠ” ì¤‘ë³µ ì½”ë“œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸°ê°€ ì‰½ì§€ ì•Šë‹¤.

### ğŸ”– 11.2.4 ê¸°ë³¸ ì •ì±…ì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±… ì¡°í•©í•˜ê¸°

ë‘ ë²ˆì§¸ ë¶€ê°€ ì •ì±…ì¸ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ Phone ìƒì† ê³„ì¸µì— ì¶”ê°€í•´ë³´ì

```java

public class RateDiscountableRegularPhone extends RegularPhone {

    private Money discountAmount;

    public RateDiscountableRegularPhone(Money amount, Duration seconds, List<Call> calls, Money discountAmount) {
        super(amount, seconds, calls);
        this.discountAmount = discountAmount;
    }

    @Override
    public Money afterCalculated(Money fee) {
        return fee.minus(discountAmount);
    }
}


public class RateDiscountableNightlyDiscountPhone extends NightlyDiscountPhone{
    private Money discountAmount;
    
    public RateDiscountableNightlyDiscountPhone(Duration seconds, Money nightlyAmount, Money regularAmount,Money discountAmount) {
        super(seconds, nightlyAmount, regularAmount);
        this.discountAmount = discountAmount;
    }

    @Override
    public Money afterCalculated(Money fee) {
        return fee.minus(discountAmount);
    }
}
```
RateDiscountableRegularPhone í´ë˜ìŠ¤ì™€ RateDiscountableNightlyDiscountPhone í´ë˜ìŠ¤ ì‚¬ì´ì— ì¤‘ë³µ ì½”ë“œë¥¼ ì¶”ê°€í–ˆë‹¤.

### ğŸ”– 11.2.5 ì¤‘ë³µ ì½”ë“œì˜ ë«ì— ê±¸ë¦¬ë‹¤

ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•œ í›„ì— ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•˜ê±°ë‚˜ ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…ì„ ì ìš©í•œ í›„ì— ì„¸ê¸ˆ ì •ì±…ì„ ì ìš©í•˜ëŠ” ê²ƒë„ ê°€ëŠ¥í•´ì•¼ í•œë‹¤.

```java
public class TaxableAndRateDiscountableRegularPhone extends TaxableRegularPhone {
    private Money discountAmount;

    public TaxableAndRateDiscountableRegularPhone(Money amount, Duration seconds, List<Call> calls, double taxRate, Money discountAmount) {
        super(amount, seconds, calls, taxRate);
        this.discountAmount = discountAmount;
    }

    @Override
    public Money afterCalculated(Money fee) {
        return super.afterCalculated(fee).minus(discountAmount);
    }

}
```
ë³µì¡ì„± ë³´ë‹¤ ë” í° ë¬¸ì œê°€ ìˆë‹¤. ìƒˆë¡œìš´ ì •ì±…ì„ ì¶”ê°€í•˜ê¸°ê°€ ì–´ë µë‹¤ëŠ” ê²ƒì´ë‹¤. 
í˜„ì¬ì˜ ì„¤ê³„ì— ìƒˆë¡œìš´ ì •ì±…ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ì„œëŠ” ë¶ˆí•„ìš”í•˜ê²Œ ë§ì€ ìˆ˜ì˜ í´ë˜ìŠ¤ë¥¼ ìƒì† ê³„ì¸µ ì•ˆì— ì¶”ê°€í•´ì•¼ í•œë‹¤.

![image](https://github.com/bithumb-study/study-object/assets/58027908/fca761bd-8433-4a44-8827-2d0e694eec07)
FixedRate ë¥¼ ì¶”ê°€ í•˜ê¸° ìœ„í•´ì„œëŠ” ìƒˆë¡œìš´ 5ê°œì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤.

í´ë˜ìŠ¤ í­ë°œ , ì¡°í•©ì˜ í­ë°œ ë¬¸ì œ
- ì´ì²˜ëŸ¼ ìƒì†ì˜ ë‚¨ìš©ìœ¼ë¡œ í•˜ë‚˜ì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê¸° ìœ„í•´ í•„ìš” ì´ìƒìœ¼ë¡œ ë§ì€ ìˆ˜ì˜ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•´ì•¼ í•˜ëŠ” ê²½ìš°

ì´ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ìƒì†ì„ í¬ê¸° í•˜ëŠ” ê²ƒì´ë‹¤.

## ğŸ“– 11.3 í•©ì„± ê´€ê³„ë¡œ ë³€ê²½í•˜ê¸°

ìƒì† ê´€ê³„ëŠ” ì»´íŒŒì¼íƒ€ì„ì— ê²°ì •ë˜ê³  ê³ ì •ë˜ê¸° ë•Œë¬¸ì— ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ë„ì¤‘ì—ëŠ” ë³€ê²½í•  ìˆ˜ ì—†ë‹¤.
ë”°ë¼ì„œ ì—¬ëŸ¬ ê¸°ëŠ¥ì„ ì¡°í•©í•´ì•¼ í•˜ëŠ” ì„¤ê³„ì— ìƒì†ì„ ì´ìš©í•˜ë©´ ëª¨ë“  ì¡°í•© ê°€ëŠ¥í•œ ê²½ë¶€ë ¬ë¡œ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€ í•´ì•¼ í•œë‹¤.

ì´ê²ƒì´ ë°”ë¡œ í´ë˜ìŠ¤ í­ë°œ ë¬¸ì œ.

í•©ì„±ì€
- ì»´íŒŒì¼ íƒ€ì„ ê´€ê³„ë¥¼ ëŸ°íƒ€ì„ ê´€ê³„ë¡œ ë³€ê²½í•¨ìœ¼ë¡œì¨ ì´ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤.
- êµ¬í˜„ì´ ì•„ë‹Œ í¼ë¸”ë¦­ ì¸í„°í˜ì´ìŠ¤ì— ëŒ€í•´ì„œë‚œ ì˜ì¡´í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ëŸ°íƒ€ì„ì— ê°ì²´ì˜ ê´€ê³„ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
- êµ¬í˜„ ì‹œì ì— ì •ì±…ë“¤ì˜ ê´€ê³„ë¥¼ ê³ ì •ì‹œí‚¬ í•„ìš”ê°€ ì—†ìœ¼ë©° ì‹¤í–‰ ì‹œì ì— ì •ì±…ë“¤ì˜ ê´€ê³„ë¥¼ ìœ ì—°í•˜ê²Œ ë³€ê²½í•  ìˆ˜ ìˆê²Œ ëœë‹¤.
- ëŸ°íƒ€ì„ ì˜ì¡´ì„±ì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ í•©ì„±ì´ ì œê³µí•˜ëŠ” ê°€ì¥ ì»¤ë‹¤ë€ ì¥ì 


### ğŸ”– 11.3.1 ê¸°ë³¸ ì •ì±… í•©ì„±í•˜ê¸°

ê° ì •ì±…ì„ ë³„ë„ì˜ í´ë˜ìŠ¤ë¡œ êµ¬í˜„

ê¸°ë³¸ ì •ì±…ê³¼ ë¶€ê°€ ì •ì±…ì„ í¬ê´„í•˜ëŠ” RatePolicy ì¸í„°í˜ì´ìŠ¤ ì¶”ê°€
```java
public interface RatePolicy {
    Money calculateFee(Phone phone);
}
```

ê¸°ë³¸ ì •ì±… êµ¬í˜„
```java
public abstract class BasicRatePolicy implements RatePolicy {

    @Override
    public Money calculateFee(Phone phone) {
        Money result = Money.ZERO;
        for (Call call : phone.getCalls()) {
            result.plus(calculateCallFee(call));
        }
        return result;
    }

    protected abstract Money calculateCallFee(Call call);
}
```
ì¼ë°˜ ìš”ê¸ˆì œ
```java
@AllArgsConstructor
public class RegularPolicy extends BasicRatePolicy {
    private Money amount;
    private Duration seconds;

    @Override
    protected Money calculateCallFee(Call call) {
        return amount.times(call.getDuration().getSeconds() / seconds.getSeconds());
    }
}
```
ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ
```java
@AllArgsConstructor
public class NightlyDiscountPolicy extends BasicRatePolicy {
    private static final int LATE_NIGHT_HOUR = 22;
    private Duration seconds; //ë‹¨ìœ„ ì‹œê°„ì €ì¥

    private Money nightlyAmount;
    private Money regularAmount;

    @Override
    protected Money calculateCallFee(Call call) {
        if (call.getFrom().getHour() > LATE_NIGHT_HOUR) {
            return nightlyAmount.times(call.getDuration().getSeconds() / seconds.getSeconds());
        }
        return regularAmount.times(call.getDuration().getSeconds() / seconds.getSeconds());
    }
}
```
ê¸°ë³¸ ì •ì±…ì„ ì´ìš©í•´ ìš”ê¸ˆ ê³„ì‚° í• ìˆ˜ ìˆë„ë¡ Phone ìˆ˜ì • 
```java
public class PhoneCalculator {
    private RatePolicy ratePolicy;
    private List<Call> calls = new ArrayList<>();

    public PhoneCalculator(RatePolicy ratePolicy) {
        this.ratePolicy = ratePolicy;
    }

    public List<Call> getCalls() {
        return Collections.unmodifiableList(calls);
    }

    public Money calculateFee() {
        return ratePolicy.calculateFee(this);
    }
}
```
PhoneCalculatorì˜ ê²½ìš°ì²˜ëŸ¼ ë‹¤ì–‘í•œ ì¢…ë¥˜ì˜ ê°ì²´ì™€ í˜‘ë ¥í•˜ê¸° ìœ„í•´ í•©ì„± ê´€ê³„ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ëŠ” í•©ì„±í•˜ëŠ” ê°ì²´ì˜ íƒ€ì…ì„ ì¸í„°í˜ì´ìŠ¤ë‚˜ 
ì¶”ìƒ í´ë˜ìŠ¤ë¡œ ì„ ì–¸í•˜ê³  ì˜ì¡´ì„± ì£¼ì…ì„ ì‚¬ìš©í•´ ëŸ°íƒ€ì„ì— í•„ìš”í•œ ê°ì²´ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤.

```java

public class Week11Application {
    public static void main(String... args) {
        //ì¼ë°˜ ìš”ê¸ˆ
        PhoneCalculator phoneCalculator = new PhoneCalculator(new RegularPolicy(Money.wons(10), Duration.ofSeconds(10)));
        //ì‹¬ì•¼ ìš”ê¸ˆ
        PhoneCalculator NightphoneCalculator = new PhoneCalculator(new NightlyDiscountPolicy(Money.wons(5), Money.wons(10), Duration.ofSeconds(10)));
    }
}
```
### ğŸ”– 11.3.2 ë¶€ê°€ ì •ì±… ì ìš©í•˜ê¸°

ë¶€ê°€ ì •ì±…ì€ RatePolicy ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•´ì•¼ í•˜ë©°, ë‚´ë¶€ì— ë˜ ë‹¤ë¥¸ RatePolicy ì¸ìŠ¤í„´ìŠ¤ë¥¼ í•©ì„±í• ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

ë¶€ê°€ ì •ì±… ì¶”ìƒí´ë˜ìŠ¤ ìƒì„±
```java
public abstract class AdditionalRatePolicy implements RatePolicy {
    private RatePolicy next;

    public AdditionalRatePolicy(RatePolicy next) {
        this.next = next;
    }

    @Override
    public Money calculateFee(PhoneCalculator phone) {
        Money fee = next.calculateFee(phone);
        return afterCalculated(fee);
    }

    abstract protected Money afterCalculated(Money fee);
}
```

Phone ì˜ ì…ì¥ì—ì„œ AddtionalRatePolicy ëŠ” RatePolicyì˜ ì—­í• ì„ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— RatePolicy êµ¬í˜„
ë˜ ë‹¤ë¥¸ ì •ì±…ê³¼ ì¡°í•©ë ìˆ˜ ìˆë„ë¡ RatePolicy íƒ€ì…ì˜ nextë¼ëŠ” ì´ë¦„ì„ ê°€ì§„ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ ë‚´ë¶€ì— í¬í•¨í•œë‹¤.

ì„¸ê¸ˆ ì •ì±…
```java
public class TaxablePolicy extends AdditionalRatePolicy {

    private double taxRatio;

    public TaxablePolicy(double taxRatio, RatePolicy next) {
        super(next);
        this.taxRatio = taxRatio;
    }

    @Override
    protected Money afterCalculated(Money fee) {
        return fee.plus(fee.times(taxRatio));
    }
}
```
ê¸°ë³¸ ìš”ê¸ˆ í• ì¸ ì •ì±…
```java
public class RateDiscountablePolicy extends AdditionalRatePolicy {
    private Money discountAmount;

    public RateDiscountablePolicy(RatePolicy next, Money discountAmount) {
        super(next);
        this.discountAmount = discountAmount;
    }

    @Override
    protected Money afterCalculated(Money fee) {
        return fee.minus(discountAmount);
    }
}
```
![image](https://github.com/bithumb-study/study-object/assets/58027908/e0a6ad96-f38a-45df-afe1-a78c79db0ae5)

### ğŸ”– 11.3.3 ê¸°ë³¸ ì •ì±…ê³¼ ë¶€ê°€ ì •ì±… í•©ì„±í•˜ê¸°

```java
public class Week11Application {
    public static void main(String... args) {
        //ì¼ë°˜ ìš”ê¸ˆ
        PhoneCalculator phoneCalculator = new PhoneCalculator(new RegularPolicy(Money.wons(10), Duration.ofSeconds(10)));
        //ì‹¬ì•¼ ìš”ê¸ˆ
        PhoneCalculator NightPhoneCalculator = new PhoneCalculator(new NightlyDiscountPolicy(Money.wons(5), Money.wons(10), Duration.ofSeconds(10)));

        PhoneCalculator TaxablePhoneCalculator = new PhoneCalculator(new TaxablePolicy(0.05, new RegularPolicy(Money.wons(10), Duration.ofSeconds(10))));

        PhoneCalculator TaxableAndDiscoutablePhoneCalculator = new PhoneCalculator(new TaxablePolicy(0.05, new RateDiscountablePolicy(Money.wons(1000), new RegularPolicy(Money.wons(10), Duration.ofSeconds(10)))));

    }
}
```
ê°ì²´ë¥¼ ì¡°í•©í•˜ê³  ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì´ ìƒì†ì„ ì‚¬ìš©í•œ ë°©ì‹ë³´ë‹¤ ë” ì˜ˆì¸¡ ê°€ëŠ¥í•˜ê³  ì¼ê´€ì„±ì´ ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•Œê²Œë ê²ƒì´ë‹¤.

í•©ì„±ì˜ ì§„ê°€ëŠ” ìƒˆë¡œìš´ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ëŠ” ì‹œì ì´ ë¼ì„œì•¼ ë¹„ë¡œì†Œ ì•Œ ìˆ˜ ìˆë‹¤.

### ğŸ”– 11.3.4 ìƒˆë¡œìš´ ì •ì±… ì¶”ê°€í•˜ê¸°
![image](https://github.com/bithumb-study/study-object/assets/58027908/1ab390ae-b2e7-4bf9-ab4a-a55046356542)

ìœ„ì˜ ê·¸ë¦¼ì²˜ëŸ¼ ì˜¤ì§ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë§Œ ì¶”ê°€í•˜ê³  ëŸ°íƒ€ì„ì— í•„ìš”í•œ ì •ì±…ë“¤ì„ ì¡°í•©í•´ì„œ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

ë” ì¤‘ìš”í•œê²ƒì€ ìš”êµ¬ì‚¬í•­ì„ ë³€ê²½í•  ë•Œ ì˜¤ì§ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ë§Œ ìˆ˜ì •í•´ë„ ëœë‹¤ëŠ” ê²ƒì´ë‹¤.

### ğŸ”– 11.3.5 ê°ì²´ í•©ì„±ì´ í´ë˜ìŠ¤ ìƒì†ë³´ë‹¤ ë” ì¢‹ì€ ë°©ë²•ì´ë‹¤.

ìƒì†ì€ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ì„¸ë¶€ì ì¸ êµ¬í˜„ì— ìì‹ í´ë˜ìŠ¤ë¥¼ ê°•í•˜ê²Œ ê²°í•©ì‹œí‚¤ê¸° ë•Œë¬¸ì— ì½”ë“œì˜ ì§„í™”ë¥¼ ë°©í•´í•œë‹¤.

ì½”ë“œë¥¼ ì¬ì‚¬ìš© í•˜ë©´ì„œë„ ê±´ì „í•œ ê²°í•©ë„ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ë” ì¢‹ì€ ë°©ë²•ì€ í•©ì„±ì„ ì´ìš©í•˜ëŠ” ê²ƒì´ë‹¤.
ìƒì†ì´ êµ¬í˜„ì„ ì¬ì‚¬ìš©í•˜ëŠ” ë° ë¹„í•´ í•©ì„±ì€ ê°ì²´ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì¬ì‚¬ìš©í•œë‹¤.

## ğŸ“– 11.4 ë¯¹ìŠ¤ì¸

- ê°ì²´ë¥¼ ìƒì„±í•  ë•Œ ì½”ë“œ ì¼ë¶€ë¥¼ í´ë˜ìŠ¤ ì•ˆì— ì„ì–´ ë„£ì–´ ì¬ì‚¬ìš©í•˜ëŠ” ê¸°ë²•
- í•©ì„±ì´ ì‹¤í–‰ ì‹œì ì— ê°ì²´ë¥¼ ì¡°í•©í•˜ëŠ” ì¬ì‚¬ìš© ë°©ë²•ì´ë¼ë©´ ë¯¹ìŠ¤ì¸ì€ ì»´íŒŒì¼ ì‹œì ì— í•„ìš”í•œ ì½”ë“œ ì¡°ê°ì„ ì¡°í•©í•˜ëŠ” ì¬ì‚¬ìš© ë°©ë²•ì´ë‹¤.
- ì½”ë“œ ì¬ì‚¬ìš©ì— íŠ¹í™”ëœ ë°©ë²•ì´ë©´ì„œë„ ìƒì†ê³¼ ê°™ì€ ê²°í•©ë„ ë¬¸ì œë¥¼ ì´ˆë˜ í•˜ì§€ ì•ŠëŠ”ë‹¤.
- í•©ì„±ì²˜ëŸ¼ ìœ ì—°í•˜ë©´ì„œë„ ìƒì†ì²˜ëŸ¼ ì‰½ê²Œ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‹¤.

### ğŸ”– 11.4.1 ê¸°ë³¸ì •ì±… êµ¬í˜„í•˜ê¸°

ì¼ë°˜ ìš”ê¸ˆì œ
```java
@AllArgsConstructor
public class RegularPolicy extends BasicRatePolicy {
    private Money amount;
    private Duration seconds;

    @Override
    protected Money calculateCallFee(Call call) {
        return amount.times(call.getDuration().getSeconds() / seconds.getSeconds());
    }
}
```
ì‹¬ì•¼ í• ì¸ ìš”ê¸ˆì œ
```java
@AllArgsConstructor
public class NightlyDiscountPolicy extends BasicRatePolicy {
    private static final int LATE_NIGHT_HOUR = 22;
    private Duration seconds; //ë‹¨ìœ„ ì‹œê°„ì €ì¥

    private Money nightlyAmount;
    private Money regularAmount;

    @Override
    protected Money calculateCallFee(Call call) {
        if (call.getFrom().getHour() > LATE_NIGHT_HOUR) {
            return nightlyAmount.times(call.getDuration().getSeconds() / seconds.getSeconds());
        }
        return regularAmount.times(call.getDuration().getSeconds() / seconds.getSeconds());
    }
}
```
### ğŸ”– 11.4.2 íŠ¸ë ˆì´íŠ¸ë¡œ ë¶€ê°€ ì •ì±… êµ¬í˜„í•˜ê¸°

ì½”ë“œì—ì„œì˜ Extends ë¬¸ì€ ë‹¨ì§€ TaxablePolicy ê°€ ì‚¬ìš©ë ìˆ˜ ìˆëŠ” ë¬¸ë§¥ì„ ì œí•œí•  ë¿ì´ë‹¤.

ìƒì†ì€ ì •ì ì´ì§€ë§Œ ë¯¹ìŠ¤ì¸ì€ ë™ì ì´ë‹¤. ìƒì†ì€ ë¶€ëª¨ í´ë˜ìŠ¤ì™€ ìì‹ í´ë˜ìŠ¤ì˜ ê´€ê³„ë¥¼ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ì‹œì ì— ê³ ì •ì‹œì¼œ ë²„ë¦¬ì§€ë§Œ 
ë¯¹ìŠ¤ì¸ì€ ì œì•½ì„ ë‘˜ë¿ ì‹¤ì œë¡œ ì–´ë–¤ ì½”ë“œì— ë¯¹ìŠ¤ì¸ë  ê²ƒì¸ì§€ë¥¼ ê²°ì •í•˜ì§€ ì•ŠëŠ”ë‹¤.

super ì˜ ì°¸ì¡°ê°€ ê°€ë¦¬í‚¤ëŠ” ëŒ€ìƒì´ ì»´íŒŒì¼ ì‹œì ì´ ì•„ë‹Œ ì‹¤í–‰ì‹œì ì— ê²°ì • ëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

ë¯¹ìŠ¤ì¸ì€ ìƒì†ë³´ë‹¤ëŠ” í•©ì„±ê³¼ ìœ ì‚¬í•˜ë‹¤. í•©ì„±ì€ ë…ë¦½ì ìœ¼ë¡œ ì‘ì„±ëœ ê°ì²´ë“¤ì„ ì‹¤í–‰ ì‹œì ì— ì¡°í•©í•´ì„œ ë” í° ê¸°ëŠ¥ì„ ë§Œë“¤ì–´ë‚´ëŠ”ë° ë¹„í•´
ë¯¹ìŠ¤ì¸ì€ ë…ë¦½ì ìœ¼ë¡œ ì‘ì„±ëœ íŠ¸ë ˆì´íŠ¸ í´ë˜ìŠ¤ë¥¼ ì½”ë“œë¡œ ì‘ì„± ì‹œì ì— ì¡°í•©í•´ì„œ ë” í° ê¸°ëŠ¥ì„ ë§Œë“¤ì–´ë‚¼ìˆ˜ìˆë‹¤.

### ğŸ”– 11.4.3 ë¶€ê°€ ì •ì±… íŠ¸ë ˆì´íŠ¸ ë¯¹ìŠ¤ì¸ í•˜ê¸°

---- 

### ğŸ”– 11.4.4 ìŒ“ì„ìˆ˜ ìˆëŠ” ë³€ê²½

ì „í†µì ìœ¼ë¡œ ë¯¹ìŠ¤ì¸ì€ íŠ¹ì •í•œ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ ì¬ì‚¬ìš©í•˜ê³  ê¸°ëŠ¥ì„ í™•ì¥í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë¼ ì™”ë‹¤.

ë¯¹ìŠ¤ì¸ì€ ìƒì† ê³„ì¸µ ì•ˆì—ì„œ í™•ì¥í•œ í´ë˜ìŠ¤ë³´ë‹¤ ë” í•˜ìœ„ì— ìœ„ì¹˜í•˜ê²Œ ëœë‹¤. ë‹¤ì‹œ ë§í•´ì„œ ë¯¹ìŠ¤ì¸ì€ ëŒ€ìƒ í´ë˜ìŠ¤ì˜ ìì‹ í´ë˜ìŠ¤ì²˜ëŸ¼
ì‚¬ìš©ë  ìš©ë„ë¡œ ë§Œë“¤ì–´ ì§€ëŠ”ê²ƒì´ë‹¤.

ë¯¹ìŠ¤ì¸ì„ ì¶”ìƒ ì„œë¸Œ í´ë˜ìŠ¤(abstract subclass) ë¼ê³  ë¶€ë¥´ê¸°ë„ í•œë‹¤.

ë¯¹ìŠ¤ì¸ì€ ê²°ë¡ ì ìœ¼ë¡œ ìŠˆí¼í´ë˜ìŠ¤ë¡œë¶€í„° ìƒì†ë  í´ë˜ìŠ¤ë¥¼ ëª…ì‹œí•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ì„ í‘œí˜„í•œë‹¤.

ë¯¹ìŠ¤ì¸ì„ ì‚¬ìš©í•˜ë©´ íŠ¹ì •í•œ í´ë˜ìŠ¤ì— ëŒ€í•œ ë³€ê²½ ë˜ëŠ” í™•ì¥ì„ ë…ë¦½ì ìœ¼ë¡œ êµ¬í˜„í•œ í›„ í•„ìš”í•œ ì‹œì ì— ì°¨ë¡€ëŒ€ë¡œ ì¶”ê°€ í• ìˆ˜ ìˆë‹¤.
ìŒ“ì„ìˆ˜ ìˆëŠ” ë³€ê²½ì´ë¼ê³  ë¶€ë¥¸ë‹¤.